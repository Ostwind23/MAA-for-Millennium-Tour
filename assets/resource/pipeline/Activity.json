{
    "$section_entry": "========== 活动1 春夜腾龙令 任务入口 ==========",
    "taskActivityBattle": {
        "doc": "活动战斗入口任务：从主界面进入活动 → 打开活动战斗页 → 选择最后一关 Final → 快速作战最大化次数并完成战斗，支持 JumpBack 异常兜底",
        "next": [
            "[JumpBack]checkOtherActivityEntryBattle",
            "openActivityBattleFromHome",
            "activityEntryRetryWaitBattle",
            "[JumpBack]Sub_Getreward",
            "[JumpBack]CloseNotification",
            "[JumpBack]ClickEmptyArea",
            "[JumpBack]Battle_cancelpage",
            "[JumpBack]activityCompletebattle",
            "[JumpBack]activityLaunchbattle",
            "[JumpBack]activityMaximization",
            "[JumpBack]activityEntermission",
            "[JumpBack]findActivityFinalStage",
            "[JumpBack]openActivityBattleEntry",
            "[JumpBack]ActivityBattle_SecondaryFallback"
        ]
    },
    "openActivityBattleFromHome": {
        "doc": "主界面点击右侧活动入口（用于活动战斗流程）",
        "recognition": "TemplateMatch",
        "template": "activity/activity_entry.png",
        "roi": [
            877,
            81,
            398,
            308
        ],
        "action": "Click",
        "post_delay": 2000,
        "timeout": 8000,
        "next": [
            "openActivityBattleEntry"
        ],
        "on_error": [
            "activityEntrySwipeLeftBattle"
        ]
    },
    "openActivityBattleEntry": {
        "doc": "活动页面底部“活动战斗”入口",
        "recognition": "TemplateMatch",
        "template": "activity/activity_battle_entry.png",
        "action": "Click",
        "post_wait_freezes": 1000,
        "next": [
            "findActivityFinalStage"
        ]
    },
    "findActivityFinalStage": {
        "doc": "活动关卡列表中查找最后一关（文本包含 Final），优先选择最右侧/最后一个结果",
        "recognition": "OCR",
        "expected": [
            "亥猪"
        ],
        "order_by": "Horizontal",
        "index": -1,
        "action": "Click",
        "post_delay": 500,
        "timeout": 8000,
        "next": [
            "activityEntermission"
        ],
        "on_error": [
            "openActivityBattleEntry"
        ]
    },
    "taskActivityMission": {
        "doc": "活动任务收取入口任务：活动商店购买目标商品 → 活动任务全部领取 → 活动签到并关闭界面，使用 JumpBack 进行异常兜底",
        "next": [
            "[JumpBack]checkOtherActivityEntryMission",
            "[JumpBack]openActivityShopFromHome",
            "[JumpBack]Sub_Getreward",
            "[JumpBack]CloseNotification",
            "[JumpBack]ClickEmptyArea",
            "[JumpBack]scanActivitySigninSlots",
            "[JumpBack]openActivitySigninEntry",
            "[JumpBack]collectAllActivityMissions",
            "[JumpBack]openActivityMissionEntry",
            "[JumpBack]confirmPurchase",
            "[JumpBack]maxPurchase",
            "[JumpBack]findActivityShopItem",
            "[JumpBack]openActivityShopEntry",
            "[JumpBack]ActivityMission_SecondaryFallback"
        ]
    },
    "openActivityShopFromHome": {
        "doc": "主界面点击右侧活动入口（用于活动任务收取流程）",
        "recognition": "TemplateMatch",
        "template": "activity/activity_entry.png",
        "roi": [
            831,
            73,
            445,
            304
        ],
        "action": "Click",
        "post_delay": 2000,
        "timeout": 8000,
        "max_hit": 1,
        "next": [
            "openActivityShopEntry"
        ],
        "on_error": [
            "activityEntrySwipeLeftMission"
        ]
    },
    "checkOtherActivityEntryBattle": {
        "doc": "活动1入口检查：若识别为活动2入口则等待后重试（战斗入口）",
        "recognition": "TemplateMatch",
        "template": "activity/activity_entry_2.png",
        "roi": [
            877,
            81,
            398,
            308
        ],
        "action": "DoNothing",
        "post_delay": 2000,
        "next": [
            "openActivityBattleFromHome"
        ]
    },
    "checkOtherActivityEntryMission": {
        "doc": "活动1入口检查：若识别为活动2入口则等待后重试（任务入口）",
        "recognition": "TemplateMatch",
        "template": "activity/activity_entry_2.png",
        "roi": [
            831,
            73,
            445,
            304
        ],
        "action": "DoNothing",
        "post_delay": 2000,
        "next": [
            "openActivityShopFromHome"
        ]
    },
    "openActivityShopEntry": {
        "doc": "活动页面底部“活动商店”入口",
        "recognition": "TemplateMatch",
        "template": "activity/activity_shop.png",
        "action": "Click",
        "post_wait_freezes": 1000,
        "max_hit": 1,
        "next": [
            "findActivityShopItem"
        ]
    },
    "findActivityShopItem": {
        "doc": "活动商店中查找需要购买的目标商品（通过 OCR 识别商品名称，默认占位文本，建议通过 pipeline_override 覆写 expected）",
        "recognition": "OCR",
        "roi": [
            341,
            35,
            898,
            623
        ],
        "expected": [
            "星魂结晶",
            "星痕之页",
            "香薰蜡烛",
            "遥控骰子",
            "魂石",
            "心海",
            "星斑玉",
            "晶精",
            "圣文石",
            "梦幻蛛晶",
            "星源晶魄",
            "本勒",
            "星痕篇章",
            "礼物",
            "突破",
            "种子",
            "肥料",
            "鱼饵",
            "蚯蚓"
        ],
        "action": "Click",
        "post_delay": 500,
        "timeout": 8000,
        "max_hit": 1,
        "next": [
            "[JumpBack]maxPurchase",
            "[JumpBack]BackButton"
        ]
    },
    "openActivityMissionEntry": {
        "doc": "活动页面底部“活动任务”入口",
        "recognition": "TemplateMatch",
        "template": "activity/activity_mission.png",
        "action": "Click",
        "post_wait_freezes": 1000,
        "max_hit": 1,
        "next": [
            "collectAllActivityMissions"
        ]
    },
    "collectAllActivityMissions": {
        "doc": "活动任务页面右上角点击“全部领取”按钮，并处理获得奖励弹窗后返回活动页面",
        "recognition": "OCR",
        "roi": [
            928,
            2,
            350,
            101
        ],
        "expected": [
            "全部领取"
        ],
        "action": "Click",
        "post_delay": 2000,
        "max_hit": 1,
        "next": [
            "[JumpBack]Sub_Getreward",
            "BackButton"
        ]
    },
    "openActivitySigninEntry": {
        "doc": "活动页面上方“活动签到”入口，这里用roi+感叹号识别来防止当天签过到后接着签到导致卡死",
        "recognition": "And",
        "all_of": [
            {
                "recognition": "TemplateMatch",
                "template": "Alert.png",
                "roi": [
                    258,
                    377,
                    149,
                    332
                ]
            },
            {
                "recognition": "TemplateMatch",
                "template": [
                    "activity/activity_signin.png"
                ],
                "roi": [
                    258,
                    377,
                    149,
                    332
                ]
            }
        ],
        "box_index": 0,
        "action": "Click",
        "post_wait_freezes": 1000,
        "max_hit": 1,
        "next": [
            "scanActivitySigninSlots"
        ]
    },
    "scanActivitySigninSlots": {
        "doc": "活动签到面板中从左往右扫描当日可签到的格子（模板匹配），点击后依次获得奖励并关闭签到页面，最后返回主界面",
        "recognition": "TemplateMatch",
        "template": "activity/activity_signin_today.png",
        "roi": [
            25,
            239,
            1225,
            155
        ],
        "order_by": "Horizontal",
        "index": 0,
        "action": "Click",
        "post_delay": 2000,
        "max_hit": 1,
        "next": [
            "[JumpBack]Sub_Getreward",
            "CloseNotification"
        ]
    },
    "activityEntermission": {
        "doc": "活动战斗：进入快速作战界面（复用 battle.json 的 entermission 配置）",
        "recognition": "TemplateMatch",
        "template": "battle/fast battle.png",
        "roi": [
            646,
            606,
            278,
            113
        ],
        "action": "Click",
        "next": [
            "activityMaximization"
        ]
    },
    "activityMaximization": {
        "doc": "活动战斗：快速作战界面中点击最大次数（复用 battle.json 的 maximization 配置）",
        "recognition": "TemplateMatch",
        "template": "maximize.png",
        "roi": [
            1006,
            483,
            265,
            151
        ],
        "action": "Click",
        "next": [
            "activityLaunchbattle"
        ]
    },
    "activityLaunchbattle": {
        "doc": "活动战斗：点击开始战斗按钮（复用 battle.json 的 launchbattle 配置）",
        "recognition": "TemplateMatch",
        "template": "battle/launch battle.png",
        "roi": [
            904,
            563,
            297,
            157
        ],
        "action": "Click",
        "post_wait_freezes": 1000,
        "next": [
            "activityCompletebattle",
            "activityCancelforSupply"
        ]
    },
    "activityCompletebattle": {
        "doc": "活动战斗：战斗结算点击完成/获得奖励（复用 battle.json 的 completebattle 配置）",
        "recognition": "TemplateMatch",
        "template": "battle finish.png",
        "roi": [
            495,
            570,
            290,
            142
        ],
        "action": "Click",
        "post_delay": 500,
        "next": [
            "[JumpBack]Sub_Getreward",
            "[JumpBack]Battle_cancelpage",
            "[JumpBack]BackButton",
            "HomeButton",
            "EndonHome"
        ]
    },
    "activityCancelforSupply": {
        "recognition": "TemplateMatch",
        "template": "daily/cancel.png",
        "roi": [
            301,
            429,
            287,
            143
        ],
        "action": "Click",
        "post_delay": 500,
        "next": [
            "[JumpBack]Battle_cancelpage",
            "[JumpBack]HomeButton",
            "EndonHome"
        ]
    },
    "activityEntrySwipeLeftBattle": {
        "doc": "活动入口识别失败时右向左滑动后重试（战斗入口）",
        "action": "Swipe",
        "begin": [
            1179,
            226,
            2,
            0
        ],
        "end": [
            1063,
            226,
            2,
            0
        ],
        "duration": 700,
        "post_delay": 500,
        "next": [
            "openActivityBattleFromHome"
        ]
    },
    "activityEntryRetryWaitBattle": {
        "doc": "活动入口未识别时等待后再尝试（战斗入口）",
        "recognition": "DirectHit",
        "action": "DoNothing",
        "post_delay": 2500,
        "max_hit": 2,
        "next": [
            "activityEntrySwipeLeftBattle"
        ]
    },
    "activityEntrySwipeLeftMission": {
        "doc": "活动入口识别失败时右向左滑动后重试（任务入口）",
        "action": "Swipe",
        "begin": [
            1179,
            226,
            2,
            0
        ],
        "end": [
            1063,
            226,
            2,
            0
        ],
        "duration": 700,
        "post_delay": 500,
        "next": [
            "openActivityShopFromHome"
        ]
    },
    "ActivityBattle_SecondaryFallback": {
        "doc": "二级兜底：仅在强条件节点均匹配失败后，才允许触发弱条件返回按钮",
        "recognition": "TemplateMatch",
        "template": [
            "home.png",
            "summon.png"
        ],
        "action": "DoNothing",
        "next": [
            "x2_back",
            "HomeButton"
        ]
    },
    "ActivityMission_SecondaryFallback": {
        "doc": "二级兜底：仅在强条件节点均匹配失败后，才允许触发弱条件返回按钮",
        "recognition": "TemplateMatch",
        "template": [
            "home.png",
            "summon.png"
        ],
        "action": "DoNothing",
        "next": [
            "BackButton",
            "HomeButton",
            "EndonHome"
        ]
    }
}